# Стратегический роадмап внедрения Data Mesh «Будущее 2.0»

## Ключевые роли в Data Mesh

| Роль | Ответственность | Где работает |
|------|-----------------|--------------|
| **Data Product Owner** | Владеет данными домена, определяет SLA, отвечает за качество и доступность data product | В каждом домене |
| **Data Engineer** | Разрабатывает ETL/ELT-процессы, строит пайплайны данных, поддерживает инфраструктуру домена | В каждом домене |
| **BI-аналитик** | Создаёт отчёты и дашборды, анализирует данные, формирует бизнес-инсайты | В каждом домене |
| **Platform Engineer** | Развивает платформу самообслуживания, создаёт инструменты и шаблоны | Платформенная команда |
| **Data Architect** | Определяет стандарты, следит за консистентностью архитектуры между доменами | Платформенная команда |
| **Data Governance Lead** | Управляет политиками доступа, качества данных, compliance | Платформенная команда |

---

## Этапы внедрения Data Mesh

```
Год 1                          Год 2                          Год 3
├──────────────────────────────┼──────────────────────────────┼──────────────────────────────┤
│  Q1-Q2: Фундамент            │  Q1-Q2: Масштабирование      │  Q1-Q4: Оптимизация          │
│  Q3-Q4: Пилот                │  Q3-Q4: Расширение           │         и зрелость           │
└──────────────────────────────┴──────────────────────────────┴──────────────────────────────┘
```

---

## Фаза 1: Фундамент (Месяцы 1-6)

**Бизнес-цель**: Создать техническую и организационную основу для Data Mesh.

**Quick Win**: Разгрузить legacy DWH уже на этом этапе — вынести неструктурированные данные (изображения, документы, BLOB) в MinIO. Это сразу улучшит производительность MS SQL и облегчит дальнейшую миграцию.

### Технические активности

| Активность | Срок | Ответственный | Результат |
|------------|------|---------------|-----------|
| **Развёртывание MinIO** | М1-М2 | Platform Engineer | Объектное хранилище в production |
| **Миграция BLOB-данных из DWH** | М2-М4 | Platform + ИИ-команда | Изображения/документы в MinIO, DWH разгружен |
| **Каталогизация DWH** | М1-М4 | Platform + ИИ-команда | Инвентаризация таблиц, выявление владельцев, связей |
| Развёртывание Iceberg + Spark | М2-М4 | Platform Engineer | LakeHouse-стек в production |
| Внедрение DataHub | М3-М5 | Platform Engineer | Каталог данных с поддержкой lineage |
| Настройка Kafka + Karapace | М3-М4 | Platform Engineer | Событийная шина со Schema Registry |
| Создание Terraform-модулей для Self-Service | М4-М6 | Platform Engineer | Шаблоны для развёртывания инфраструктуры |
| Интеграция Keycloak + Ranger | М4-М6 | Platform Engineer | Единая аутентификация и авторизация |

### Организационные активности

| Активность | Срок | Ответственный | Результат |
|------------|------|---------------|-----------|
| Определение доменов и их границ | М1-М2 | Data Architect | Карта доменов (см. Task 4) |
| Разработка Data Governance политик | М2-М4 | Data Governance Lead | Документ с правилами владения и качества |
| Формирование платформенной команды | М1-М2 | CTO | Команда из 5-7 человек |
| Обучение платформенной команды | М2-М4 | Внешние консультанты | Сертификации Spark, Iceberg, Kafka |

**Milestone**: Платформа готова к пилотному внедрению. Legacy DWH разгружен от BLOB-данных.

---

## Фаза 2: Пилот (Месяцы 7-12)

**Бизнес-цель**: Проверить модель Data Mesh на одном домене, накопить опыт.

### Выбор пилотного домена

| Домен | Обоснование выбора |
|-------|-------------------|
| **ИИ-сервисы (обработка изображений)** | Уже использует MinIO для изображений (сделано в Фазе 1), команда участвовала в каталогизации, независимый bounded context, высокая мотивация команды |

### Паттерн миграции: Anti-Corruption Layer

При миграции используем паттерн **Anti-Corruption Layer (ACL)** для изоляции новой архитектуры от legacy:
- **ACL-сервис** транслирует запросы между LakeHouse и legacy DWH
- Новые сервисы работают только с LakeHouse, ACL скрывает legacy
- Постепенное переключение: когда данные мигрированы, ACL перестаёт обращаться к legacy
- Изоляция позволяет развивать новую архитектуру без оглядки на ограничения MS SQL

### Активности пилота

| Активность | Срок | Результат |
|------------|------|-----------|
| Назначение Data Product Owner | М7 | DPO для ИИ-домена на полной занятости |
| Разработка Anti-Corruption Layer | М7-М8 | ACL-сервис для трансляции запросов legacy ↔ LakeHouse |
| Миграция структурированных данных | М8-М10 | Метаданные изображений, результаты анализа — в Iceberg |
| Создание Data Products | М9-М11 | 3-5 продуктов: витрины для ML-моделей, API для клиник |
| Публикация в DataHub | М10-М11 | Data Products доступны другим доменам |
| Настройка EDA: Клиники → ИИ | М10-М12 | События о новых снимках через Kafka |
| Ретроспектива и корректировка | М12 | Lessons Learned, обновление стандартов |

### KPI пилота

| Метрика | Целевое значение |
|---------|------------------|
| Время создания нового отчёта | < 2 дней |
| Доступность данных (SLA) | 99.5% |
| Время обнаружения данных в каталоге | < 5 минут |
| NPS от бизнес-пользователей | > 7/10 |

**Milestone**: Пилот успешен, модель подтверждена.

---

## Фаза 3: Масштабирование (Месяцы 13-24)

**Бизнес-цель**: Распространить Data Mesh на все ключевые домены, вывести legacy из критического пути.

### Подключение новых доменов

| Квартал | Домены | Особенности |
|---------|--------|-------------|
| Q1 (М13-М15) | Финтех (Банк) | Платежи, кредиты — высокие требования к SLA, ACL для legacy |
| Q1 (М13-М15) | Клиники | Приёмы, пациенты — интеграция с ИИ-сервисами через EDA |
| Q2 (М16-М18) | Аналитика (головной офис) | Консолидированная отчётность для акционеров |
| Q3 (М19-М21) | Фармацевтика | Производственные данные, логистика |
| Q4 (М22-М24) | Медицинская электроника | IoT-телеметрия, предиктивное обслуживание |

### Параллельные активности

| Активность | Срок | Результат |
|------------|------|-----------|
| Автоматизация onboarding доменов | М13-М15 | Self-Service портал для создания домена за 1 день |
| Внедрение Data Quality Framework | М14-М16 | Great Expectations интегрирован в пайплайны |
| Миграция критичных ETL с legacy | М15-М20 | 80% ETL-процессов на Airflow+Spark |
| Вывод Apache Camel | М18-М24 | Все интеграции через Kafka |
| Federated Governance | М16-М20 | Автоматические проверки compliance в CI/CD |

### KPI масштабирования

| Метрика | Целевое значение |
|---------|------------------|
| Количество Data Products | > 50 |
| Покрытие DataHub (% таблиц с описанием) | > 80% |
| Среднее время onboarding нового домена | < 2 недели |
| Доля self-service запросов (без участия платформы) | > 70% |

**Milestone**: Все ключевые домены в Data Mesh, legacy — только для исторических данных.

---

## Фаза 4: Оптимизация и зрелость (Месяцы 25-36)

**Бизнес-цель**: Достичь полной автономии доменов, отказаться от legacy, включить новые бизнес-направления.

### Активности

| Активность | Срок | Результат |
|------------|------|-----------|
| Полный вывод MS SQL Server | М25-М30 | Все данные в LakeHouse, legacy выключен |
| Real-time аналитика | М26-М30 | Streaming-витрины на Kafka + ClickHouse |
| Data Marketplace | М28-М32 | Внутренний маркетплейс Data Products |
| Подключение новых подразделений | М30-М36 | Фарма/электроника при M&A — за 1 месяц |
| FinOps для данных | М32-М36 | Chargeback модель: домены платят за потреблённые ресурсы |

### KPI зрелости

| Метрика | Целевое значение |
|---------|------------------|
| Время подключения нового подразделения | < 1 месяц |
| Доля real-time данных | > 30% |
| Экономия TCO vs legacy | > 40% |
| Data Products в production | > 100 |

**Milestone**: Data Mesh — основная модель работы с данными в компании.

---

## Gantt-диаграмма (упрощённая)

```
                        Год 1                    Год 2                    Год 3
                   Q1   Q2   Q3   Q4       Q1   Q2   Q3   Q4       Q1   Q2   Q3   Q4
                   ─────────────────       ─────────────────       ─────────────────
MinIO + BLOB-миграц████████                                        
Платформа          ░░░░████████                                    
Пилот: ИИ-сервисы           ░░░░████████                           
Финтех + Клиники                        ████████                   
Аналитика                                    ████████              
Фармацевтика                                      ████████         
Электроника                                            ████████    
Вывод Camel                              ░░░░░░░░████████          
Вывод MS SQL                                              ████████████
Real-time                                                  ░░░░████████
FinOps                                                          ████████

████ = активная фаза    ░░░░ = подготовка
```

---

## Бюджет роадмапа

| Фаза | Период | Затраты | Примечание |
|------|--------|---------|------------|
| Фундамент | М1-М6 | ~25 млн ₽ | Инфраструктура + обучение + консультанты |
| Пилот | М7-М12 | ~20 млн ₽ | Миграция данных + найм DPO + доработки |
| Масштабирование | М13-М24 | ~45 млн ₽ | Подключение 4 доменов + автоматизация |
| Оптимизация | М25-М36 | ~30 млн ₽ | Real-time + marketplace + финализация |
| **ИТОГО** | 3 года | **~120 млн ₽** | Включено в TCO LakeHouse |

---

## Риски и митигация

| Риск | Вероятность | Митигация |
|------|-------------|-----------|
| Сопротивление доменов | Высокая | Quick wins в пилоте, амбассадоры изменений |
| Нехватка Data Engineers | Средняя | Программа обучения, найм заранее |
| Затягивание вывода legacy | Высокая | Жёсткие дедлайны, feature freeze для legacy |
| Конфликты владения данными | Средняя | Data Governance Committee, чёткие политики |

---

## Связь с бизнес-целями

| Бизнес-цель | Как Data Mesh помогает | Когда достигается |
|-------------|------------------------|-------------------|
| Портал самообслуживания для аналитиков | DataHub + Trino + JupyterHub | Конец Года 1 |
| Подключение новых подразделений без перестройки | Self-service onboarding доменов | Год 2 |
| Сокращение time-to-market для отчётов | Data Products готовы к использованию | Год 1 (пилот) |
| Масштабирование до петабайтов | LakeHouse с горизонтальным масштабированием | Год 2-3 |
| Near-real-time аналитика | Kafka + streaming витрины | Год 3 |

---

## Детальная таблица активностей по кварталам

| Год | Квартал | Фаза | Ключевые активности |
|-----|---------|------|---------------------|
| 1 | Q1 | Фундамент | Развёртывание MinIO, миграция BLOB из DWH, каталогизация, формирование команды |
| 1 | Q2 | Фундамент | Iceberg+Spark, DataHub, Kafka, Terraform-модули, Keycloak+Ranger |
| 1 | Q3 | Пилот | Пилот ИИ-сервисов: ACL, миграция метаданных, назначение DPO |
| 1 | Q4 | Пилот | Первые Data Products ИИ, EDA Клиники→ИИ, ретроспектива |
| 2 | Q1 | Масштабирование | Подключение Финтеха и Клиник, автоматизация onboarding |
| 2 | Q2 | Масштабирование | Подключение Аналитики, Data Quality Framework |
| 2 | Q3 | Масштабирование | Подключение Фармацевтики, миграция ETL |
| 2 | Q4 | Масштабирование | Подключение Электроники, вывод Camel |
| 3 | Q1 | Оптимизация | Вывод MS SQL Server (начало) |
| 3 | Q2 | Оптимизация | Вывод MS SQL Server (завершение), Real-time аналитика |
| 3 | Q3 | Оптимизация | Data Marketplace |
| 3 | Q4 | Зрелость | FinOps, поддержка новых M&A |
